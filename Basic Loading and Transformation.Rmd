---
title: "DATA 607 - Assignment 1 - Basic Loading and Transformation"
author: "Preston Peck"
date: "8/29/2021"
output: html_document
---

# Overview

A FiveThirtyEight study categorized the content of 233 Super Bowl ads from 10 major companies and tagged them according to whether or not it was funny, patriotic, and/or depicting dangerous situations in addition to whether or not it had a celebrity, animals, and/or sexual imagery and whether or not it showed the product quickly.

The study found that comedic ads featuring an animal with elements of sex accounted for the vast majority.

<https://projects.fivethirtyeight.com/super-bowl-ads/>



# Analysis
### Import CSV
##### Remote

```{r}
ads <- read.csv("https://github.com/PPPeck313/DATA-607-Assignment-1-Basic-Loading-and-Transformation/blob/908af816819f69a5f53a8a18be522fedeecb31e8/superbowl-ads.csv")
```

##### Local

```{r}
ads <- read.csv("superbowl-ads.csv")
```

### Select Subset

```{r}
adsSubset <- ads[, !(names(ads) %in% c("superbowl_ads_dot_com_url", "youtube_url"))]
```

### Rename Columns

Conforming boolean columns to start with is/has/can/should

```{r}
categories <- c(
  "is_funny", 
  "is_shown_quick", 
  "is_patriotic", 
  "has_celebrity", 
  "has_danger", 
  "has_animals", 
  "has_sex"
)

colnames(adsSubset) = c(
  "year", 
  "brand",
  categories
)
```

### Transform Data

```{r}
adsSubset$is_funny <- as.numeric(as.logical(adsSubset$is_funny))
adsSubset$is_shown_quick <- as.numeric(as.logical(adsSubset$is_shown_quick))
adsSubset$is_patriotic <- as.numeric(as.logical(adsSubset$is_patriotic))
adsSubset$has_celebrity <- as.numeric(as.logical(adsSubset$has_celebrity))
adsSubset$has_danger <- as.numeric(as.logical(adsSubset$has_danger))
adsSubset$has_animals <- as.numeric(as.logical(adsSubset$has_animals))
adsSubset$has_sex <- as.numeric(as.logical(adsSubset$has_sex))
```

### Aggregate & Order
##### Count by category

```{r}
colSums(adsSubset[!(names(adsSubset) %in% c("year", "brand"))])
```

##### Count by brand

```{r}
adsSubset$total <- 1

aggregatedBrandsAdsSubset <- aggregate(adsSubset[c("total")], adsSubset[c("brand")], sum)
aggregatedBrandsAdsSubset[order(-aggregatedBrandsAdsSubset$total),]
```

##### Count by category set

```{r}
aggregateCategoryAdsTotal <- function(columns) {
  aggregateColumns <- if (missing(columns)) categories else c(columns, categories)
  
  aggregatedAdsSubset <- aggregate(adsSubset[c("total")], adsSubset[aggregateColumns], sum)
  aggregatedAdsSubset$set <- apply(aggregatedAdsSubset, 1, function(row) paste(
    c(
      if(row[["is_funny"]] == 1) "Funny",
      if(row[["is_shown_quick"]] == 1) "Quick",
      if(row[["is_patriotic"]] == 1) "Patriotic",
      if(row[["has_celebrity"]] == 1) "Celebrity",
      if(row[["has_danger"]] == 1) "Danger",
      if(row[["has_animals"]] == 1) "Animal",
      if(row[["has_sex"]] == 1) "Sex"
    ), collapse = ","
  ))
  
  aggregateColumnsOutput <- setdiff(c(aggregateColumns, "set", "total"), categories)
  aggregateColumnsOrder <- setdiff(c("total", aggregateColumns), categories)
  aggregatedAdsSubset <- aggregatedAdsSubset[, aggregateColumnsOutput]
  return(aggregatedAdsSubset)
}

aggregateCategoryAdsSubset <- aggregateCategoryAdsTotal()
aggregateCategoryAdsSubset[order(-aggregateCategoryAdsSubset$total),]
```

##### Count by brand and category set

```{r}
aggregateBrandCategoryAdsSubset <- aggregateCategoryAdsTotal(c("brand"))
aggregateBrandCategoryAdsSubset <- aggregateBrandCategoryAdsSubset[order(aggregateBrandCategoryAdsSubset$brand, -aggregateBrandCategoryAdsSubset$total),]
aggregateBrandCategoryAdsSubset[!duplicated(aggregateBrandCategoryAdsSubset$brand),] 
```



# Conclusions

The study concludes that these topics based on overwhelming presence must therefore be the most beloved, however, the study measured quantity, not quality. It supposed that popularity is positive, but renown and notoriety are two sides of the same coin and companies, no matter how popular, big, or old, don't always know the hearts of their audiences.

Metrics which might be required to prove quality and effectiveness would be likes and sentiment among comments on the commercial's archive. What would be interesting to do would be to measure reception (and financial impact, though it would no doubt be difficult to isolate in a sea of other campaign pushes) at the time and over time to today to see what's remained culturally relevant and still in our zeitgeist.